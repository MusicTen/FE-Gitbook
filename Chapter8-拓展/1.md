# 后台知识汇总

多台服务器可以共用同一个IP(这种骚操作:负载均衡)，一个IP可以绑定一个二级域名，部署在它们上的资源就不是跨域请求的

### 负载均衡算法

> 负载均衡算法决定了后端的哪些健康服务器会被选中。下面是几个常用的算法：
>
> **轮询**：为第一个请求选择健康池中的第一个后端服务器，然后按顺序往后依次选择，直到最后一个，然后循环。
>
> **最小连接**：优先选择连接数最少，也就是压力最小的后端服务器，在会话较长的情况下可以考虑采取这种方式。
>
> **散列**：根据请求源的 IP 的散列（hash）来选择要转发的服务器。这种方式可以一定程度上保证特定用户能连接到相同的服务器。如果你的应用需要处理状态而要求用户能连接到和之前相同的服务器，可以考虑采取这种方式。
>
> 最后，想要解决负载均衡器的单点故障问题，可将第二个负载均衡器连接到第一个上，形成一个集群

### DNS

> 它的作用是将用户请求的URL映射为具体的IP地址，全世界有13台根服务器，但通常为我们进行域名解析的并不是根服务器，而是直接访问我们的 LDNS(网络运营商维护)。

最早的负载均衡就是利用搭建本地 DNS 服务器实现的，实现方式简单易懂，为同一个主机名分配多个映射 ，可采用轮循/随机等方式分配请求。看上去没什么问题，但是在使用过程中会发现，如果其中一个地址down机，我们是无法及时发现的，如果有用户被分配到这个主机就会出现访问失败的状况，同时我们也无法判断每个server的负载，可能会出现，某个server几乎闲置，另外一个server负载压力极高的情况。

### 反向代理

> 名词：Nginx。高性能，轻量级。Nginx可作为HTTP服务器，在**处理高并发请求**的时候拥有比现在主流的Apache服务器更高的性能，同时Nginx也是一个优秀的反向代理服务器。

第一次听到“反向代理”，可能有些陌生，但如果了解与之对应的正向代理就很好理解了，正向代理通常由客户端主动链接，比如我们的科学的上网方式就是使用正向代理，以达到间接访问网站的目。而反向代理在服务器端，无需主动链接，当我们访问拥有反向代理的网站时，实际访问的是其反向代理服务器，而非真正的服务器，当请求到达反向代理服务器时，反向代理服务器再将请求转发至服务器。反向代理是实现负载均衡的主流手段之一，通常使用Nginx等服务器搭建，Nginx同样拥有众多的分配策略，以保证平均分配压力。

### CDN

 视频总在缓冲，图片各种加载不出来，几年前是再正常不过的事了，在当时大家也没觉得是回事，但是问题既然存在就应该是有办法解决的，那么我们如何避免这样的情况呢？这就是要说的——内容分发网络（CDN）。CDN简单的来说就是存储一些静态文件的一台或多台服务器，通过复制，缓存等方式，将文件保存其中。

**1. 哪些是静态文件？**

CSS，HTML，图片，媒体都属于静态文件，也就是说用户发送的请求不会影响静态文件的内容，而jsp，php等文件就不属于静态文件，因为他们的内容会因我们的请求而发生改变。

**2. CDN如何实现加速？**

通常情况下，我们所要的数据都是从主服务器中获取，但假如我们的主服务器在南方，而访问用户在北方，那么访问速度就会相对变慢，变慢的原因有很多，例如传输距离，运营商，带宽等因素，而使用CDN技术的话，我们会将CDN节点分布在各地，当用户发送请求到达服务器时，服务器会根据用户的区域信息，为用户分配最近的CDN服务器。

**3. CDN数据从哪里来？**

复制，缓存，CDN服务器可以在用户请求后缓存文件，也可以主动抓取主服务器内容。